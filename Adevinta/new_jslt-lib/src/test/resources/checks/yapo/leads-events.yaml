tests:
  - name: leads-events-suite.jslt compiles
    type: compile
    expression: |
      import "checks/yapo/leads-events-suite.jslt" as yapo
      yapo(.)
  - name: leads-events-suite.jslt - check leads events schemas and values
    expected:
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: provider_id_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: provider_id_verification
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: provider_type_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: provider_product_type_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: provider_product_type_verification
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: actor_id_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: actor_id_valid_format
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: actor_sptid_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: actor_sptid_valid_format
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: device_environment_id_not_null_and_not_empty
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: device_environment_id_valid_format
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: device_type_not_null_and_not_empty
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: device_type_verification
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: event_id_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: event_name_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: event_type_not_null_and_not_empty
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: event_type_verification
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: event_creation_date_verification
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: event_page_view_id_not_null_and_not_empty
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: event_schema_verification
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: published_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: published_valid_format
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: tracker_type_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: deploy_stage_valid_value
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_type_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_type_verification
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_url_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_adId_patern
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_adType_verification
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_category_patern
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_contentId_patern
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_price_integer_positive
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_publisherType_verification
            check-result: 'true'
            check-impact: critical
          delta: 1  
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_inReplyTo_id_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_inReplyTo_id_valid_format
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_inReplyTo_publisherType_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1   
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_inReplyTo_publisherType_verification
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_inReplyTo_adType_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_inReplyTo_adType_verification
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_inReplyTo_contentId_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_inReplyTo_contentId_patern
            check-result: 'true'
            check-impact: critical
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_category_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_category_valid_format
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_location_address_region_not_null_and_not_empty
            check-result: 'true'
            check-impact: minor
          delta: 1
      - quality.check:
          tags:
            product-type: m-site
            event-type: call
            object-type: 'phonecontact'
            check-suite: yapo.leads-events-suite
            check-name: object_location_address_region_valid_format
            check-result: 'true'
            check-impact: minor
          delta: 1
    expression: |
      import "checks/yapo/leads-events-suite.jslt" as leads-events
      let event =
      {
      "@id":"31ab57d2-f362-4c8b-a544-50273b951d56",
      "@type":"Call",
      "creationDate":"2021-01-12T21:03:07.884Z",
      "deployStage":"pre",
      "deployTag":"TealiumAutoProtect",
      "actor":{
      "@id":"sdrn:yapo.cl:user:1543870",
      "spt:userId":"sdrn:yapo.cl:user:1543870"
      },
      "device":{
      "@type":"Device",
      "acceptLanguage":"es-ES",
      "deviceType":"mobile",
      "environmentId":"sdrn:schibsted:environment:897f670b-d7f5-41f9-8fda-a653e69d167a",
      "jweIds":"eyJpc3N1ZWRBdCI6IjIwMjAtMTItMTdUMTM6Mjk6MDFaIiwiZW5jIjoiQTEyOENCQy1IUzI1NiIsImFsZyI6ImRpciIsImtpZCI6IjIifQ..na2TDAdSQqUZ7ugA-RD77g.yNJ8d_lh5HA4yhFkqwz9VgRp5CcFbb11T2kcDl2JU_CTZaz6VIEFDxDbS52Z6hSesP8HJuOmKt3h-MvGAOioxE7oplG1RtlIVupGUifjrV4Bw3n5-bf32O192o4RfX9T8kO0xMNtzW9Pq6793inbLeSr9cYQ56pSsVeMgn5FtsF_2rsjwtILPHJSqS2uSDHWOt2rcyyIkIGOdpkjV0tsEzDv6kj0f60SYnoM71uimGc.nq8vSJonKQh9cYjfxDccKQ",
      "localStorageEnabled":true,
      "screenSize":"375x812",
      "userAgent":"Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1",
      "viewportSize":"375x812"
      },
      "name":"Ad phone whatsapp number contacted",
      "object":{
      "@id":"sdrn:yapocl:phonecontact:4961145",
      "@type":"PhoneContact",
      "adId":4961145,
      "adType":"sell",
      "categories":[
          {
          "@type":"MarketplaceCategory",
          "level":1,
          "localId":"1220",
          "localName":"Comprar",
          "name":"Comprar"
          },
          {
          "@type":"MarketplaceCategory",
          "level":0,
          "localId":"1000",
          "localName":"Inmuebles",
          "name":"Inmuebles"
          }
      ],
      "category":"Inmuebles > Comprar",
      "contentId":"4961145",
      "inReplyTo":{
      "@id":"sdrn:yapocl:classified:4961145",
      "@type":"ClassifiedAd",
      "adType":"sell",
      "category":"Inmuebles > Comprar",
      "contentId":"4961145",
      "location":{
      "@type":"PostalAddress",
      "addressRegion":"Región Metropolitana"
      },
      "name":"Departamento amplio en Lo Prado, Región Metropolitana | dev08.yapo.cl",
      "publisherType":"pro"
      },
      "location":{
      "@type":"PostalAddress",
      "addressRegion":"Región Metropolitana"
      },
      "name":"Departamento amplio en Lo Prado, Región Metropolitana | dev08.yapo.cl",
      "price":58000000,
      "published":"2021-01-12T21:02:16.443Z",
      "publisherType":"pro",
      "url":"https://m.dev08.yapo.cl/region_metropolitana/comprar/departamento_amplio_en_lo_prado_4961145.htm?ca=15_s&oa=4961145&xsp=0"
      },
      "origin":{
      "category":"Inmuebles > Comprar",
      "id":"4961145",
      "name":"Departamento amplio en Lo Prado",
      "type":"ClassifiedAd",
      "url":"https://m.dev08.yapo.cl/region_metropolitana/comprar?ret=&ps=&pe=&q=&st=s&f=a"
      },
      "pageViewId":"a1b98bfb-f386-4082-9475-2eca3ac12474",
      "provider":{
      "@id":"sdrn:schibsted:client:yapocl",
      "@type":"Organization",
      "productType":"M-Site"
      },
      "published":"2021-01-12T21:02:16.443Z",
      "schema":"http://schema.schibsted.com/events/tracker-event.json/230.json",
      "target":{
      "@id":"sdrn:yapocl:classified:4961145",
      "@type":"ClassifiedAd",
      "adId":4961145,
      "adType":"sell",
      "categories":[
          {
          "@type":"MarketplaceCategory",
          "level":1,
          "localId":"1220",
          "localName":"Comprar",
          "name":"Comprar"
          },
          {
          "@type":"MarketplaceCategory",
          "level":0,
          "localId":"1000",
          "localName":"Inmuebles",
          "name":"Inmuebles"
          }
      ],
      "category":"Inmuebles > Comprar",
      "contentId":"4961145",
      "location":{
      "@type":"PostalAddress",
      "addressRegion":"Región Metropolitana"
      },
      "name":"Departamento amplio en Lo Prado, Región Metropolitana | dev08.yapo.cl",
      "price":58000000,
      "published":"2021-01-12T21:02:16.443Z",
      "publisherType":"pro",
      "url":"https://m.dev08.yapo.cl/region_metropolitana/comprar/departamento_amplio_en_lo_prado_4961145.htm?ca=15_s&oa=4961145&xsp=0"
      },
      "tracker":{
      "eventBuilderVersion":"1.0.34",
      "name":"Pulse Node.js SDK",
      "type":"JS",
      "version":"4.1.10-54417"
      }
      }
      leads-events($event)
  